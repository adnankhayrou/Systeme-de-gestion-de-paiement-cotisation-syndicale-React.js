name: Send Email on Push

on:
  push:
    branches:
      - main

jobs:
  send-email:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 14

      - name: Install Dependencies
        run: npm install @sendgrid/mail

      - name: Send Email
        run: |
          const sgMail = require('@sendgrid/mail');
          sgMail.setApiKey(process.env.SENDGRID_API_KEY);

          const msg = {
            to: 'adnanekhayrou3@gmail.com',
            from: 'github@send.com',
            subject: 'GitHub Action Notification',
            text: 'A new push has been made to the repository.',
          };

          sgMail.send(msg);
        env:
          SENDGRID_API_KEY: ${{ secrets.SENDGRID_API_KEY }}

